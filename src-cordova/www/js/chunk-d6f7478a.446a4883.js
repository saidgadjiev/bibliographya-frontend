(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d6f7478a"],{"6a89":function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("list",{attrs:{"infinite-load":t.infiniteLoad,"reset-id":t.resetId,"infinite-id":t.infiniteId},on:{"update:infiniteId":function(e){t.infiniteId=e},"update:infinite-id":function(e){t.infiniteId=e}},scopedSlots:t._u([{key:"item",fn:function(e){var n=e.item;return[i("bug-card",t._b({},"bug-card",n,!1,!0))]}}])},[i("template",{slot:"sidebar"},[i("side-bar",{on:{all:t.applyAllFilter,"not-assigned":t.applyNotAssignedFilter,"assigned-me":t.applyAssignedMeFilter,closed:t.applyClosedFilter,ignored:t.applyIgnoredFilter}})],1),i("template",{slot:"smSidebar"},[i("side-list",{on:{all:t.applyAllFilter,"not-assigned":t.applyNotAssignedFilter,"assigned-me":t.applyAssignedMeFilter,closed:t.applyClosedFilter,ignored:t.applyIgnoredFilter}})],1),i("template",{slot:"no-results"},[i("v-card",[i("v-card-text",[t._v("\n        Нет данных\n      ")])],1)],1)],2)},s=[],a=i("cebc"),r=i("f3ce"),l=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("aside",{staticClass:"sidebar"},[i("side-list",t._g({},t.$listeners))],1)},c=[],o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-card",[i("v-list",{attrs:{dense:""}},[i("v-list-tile",{class:{active:1===t.clickedIndex},attrs:{href:""},on:{click:function(e){return t.click(1,"all")}}},[i("v-list-tile-content",[i("v-list-tile-title",[t._v("Все")])],1)],1),i("v-list-tile",{class:{active:2===t.clickedIndex},attrs:{href:""},on:{click:function(e){return t.click(2,"not-assigned")}}},[i("v-list-tile-content",[i("v-list-tile-title",[t._v("Не назначенные")])],1)],1)],1),i("v-divider",{staticClass:"grey lighten-2"}),i("v-list",{attrs:{dense:"",subheader:""}},[i("v-subheader",[t._v("Мои")]),i("v-list-tile",{class:{active:3===t.clickedIndex},attrs:{href:""},on:{click:function(e){return t.click(3,"assigned-me")}}},[i("v-list-tile-content",[i("v-list-tile-title",[t._v("Открытые")])],1)],1),i("v-list-tile",{class:{active:4===t.clickedIndex},attrs:{href:""},on:{click:function(e){return t.click(4,"closed")}}},[i("v-list-tile-content",[i("v-list-tile-title",[t._v("Исправленные")])],1)],1),i("v-list-tile",{class:{active:5===t.clickedIndex},attrs:{href:""},on:{click:function(e){return t.click(5,"ignored")}}},[i("v-list-tile-content",[i("v-list-tile-title",[t._v("Проигнорированные")])],1)],1)],1)],1)},u=[],d={name:"SideList",data:function(){return{clickedIndex:1}},methods:{click:function(t,e){this.clickedIndex=t,this.$emit(e)}}},f=d,p=(i("88e9"),i("2877")),g=i("6544"),b=i.n(g),h=i("b0af"),v=i("ce7e6"),m=i("8860"),_=i("ba95"),x=i("5d23"),k=i("e0c7"),y=Object(p["a"])(f,o,u,!1,null,"ddd17d04",null),I=y.exports;b()(y,{VCard:h["a"],VDivider:v["a"],VList:m["a"],VListTile:_["a"],VListTileContent:x["a"],VListTileTitle:x["b"],VSubheader:k["a"]});var C={name:"SideBar",components:{SideList:I}},F=C,$=Object(p["a"])(F,l,c,!1,null,"ae22a942",null),A=$.exports,L=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-card",[i("bug-fix-title",t._b({staticClass:"pb-0"},"bug-fix-title",t.$attrs,!1)),i("v-card-title",[i("h2",[t._v(t._s(t.theme))])]),i("v-card-text",{staticClass:"pt-0"},[i("span",{staticClass:"font-weight-regular title"},[t._v(t._s(t.bugCase))])]),i("bug-actions",t._g(t._b({},"bug-actions",t.$attrs,!1),t.$listeners))],1)},V=[],O=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-card-actions",[i("v-layout",{attrs:{row:"",wrap:""}},t._l(t.actions,function(e,n){return i("v-flex",{key:n,attrs:{xs12:""}},[i("bug-button",t._g(t._b({key:e.name,attrs:{action:e}},"bug-button",t.$attrs,!1),t.$listeners))],1)}),1)],1)},B=[],N=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("v-btn",{attrs:{block:"",color:"primary",loading:t.loading,disabled:t.loading},on:{click:t.doAction}},[t._v(t._s(t.action.caption)+"\n  ")]),i("textarea-dialog",{attrs:{ok:t.okFunction,placeholder:"Комментарий",visible:t.dialogVisible,"ok-caption":"Ок","required-text":"Введите комментарий"},on:{"update:visible":function(e){t.dialogVisible=e}}})],1)},S=[],j=(i("06db"),i("c5f6"),i("79a3")),T=i("0a2a"),w=i("db49"),E={name:"BugButton",components:{TextareaDialog:T["a"]},inheritAttrs:!1,data:function(){return{okFunction:function(){},dialogVisible:!1,loading:!1}},props:{id:{type:Number},action:{type:Object,required:!0},status:{type:Number}},methods:{doAction:function(){switch(this.action.name){case w["c"].ASSIGN_ME:this.assignMe();break;case w["c"].IGNORE:this.okFunction=this.ignore,this.dialogVisible=!0;break;default:this.complete();break}},updateFixerInfo:function(t){this.$emit("update:actions",t.actions),this.$emit("update:fixer",t.fixer),this.$emit("update:fixerId",t.fixer.userId)},assignMe:function(){var t=this;t.loading=!0,j["a"].assignMe(this.id,{signal:this.action.signal,status:this.status}).then(function(e){t.updateFixerInfo(e.data),t.loading=!1},function(e){if(409===e.response.status){t.updateFixerInfo(e.response.data);var i=t.fixer,n="<a href=\"'/biographies/"+i.userId+'">'+i.firstName+" "+i.lastName+"</a>,&nbsp;уже взял исправление на себя.";t.$swal.fire({html:n,type:"error",showCloseButton:!0})}t.loading=!1})},ignore:function(t){var e=this;e.dialogVisible=!1,e.loading=!0,j["a"].complete(this.id,{signal:this.action.signal,status:this.status,info:t}).then(function(t){e.$emit("update:actions",t.data.actions),e.$emit("update:info",t.data.info),e.$emit("update:status",t.data.status)}).finally(function(){e.loading=!1})},complete:function(){var t=this;t.loading=!0,j["a"].complete(this.id,{signal:this.action.signal,status:this.status}).then(function(e){t.$emit("update:status",e.data.status),t.$emit("update:actions",e.data.actions),t.$emit("update:fixerId",e.data.fixerId),t.$emit("update:fixer",e.data.fixer),t.$emit("update:info",e.data.info),t.loading=!1},function(e){t.loading=!1})}}},q=E,D=i("8336"),G=Object(p["a"])(q,N,S,!1,null,"73e6fce8",null),M=G.exports;b()(G,{VBtn:D["a"]});var R={name:"BugActions",inheritAttrs:!1,components:{BugButton:M},props:{actions:Array}},U=R,J=i("99d9"),P=i("0e8f"),K=i("a722"),z=Object(p["a"])(U,O,B,!1,null,"2413d282",null),H=z.exports;b()(z,{VCardActions:J["a"],VFlex:P["a"],VLayout:K["a"]});var Q=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-card-text",[i("div",[t.fixer?i("div",[i("span",[t._v("\n        Исполнитель:\n        "),i("router-link",{staticClass:"bib-a",attrs:{to:t._fixerAccountLink}},[t._v(t._s(t._fixerFio))])],1)]):t._e(),i("div",[t._v("\n      Статус:\n      "),i("strong",[t._v(t._s(t._fixStatus))])]),t.info?i("div",[t._v("\n      Комментарий:\n      "),i("strong",[t._v(t._s(t.info))])]):t._e()])])},W=[],X={name:"BugFixTitle",props:{status:{type:Number},fixer:{type:Object},info:{type:String}},computed:{_fixStatus:function(){switch(this.status){case w["d"].PENDING:return"В обработке";case w["d"].CLOSED:return"Закрыто";case w["d"].IGNORED:return"Закрыто без исправления"}return null},_fixerFio:function(){return this.fixer.lastName+" "+this.fixer.firstName},_fixerAccountLink:function(){return"/biographies/"+this.fixer.userId}}},Y=X,Z=Object(p["a"])(Y,Q,W,!1,null,"91af3684",null),tt=Z.exports;b()(Z,{VCardText:J["b"]});var et={name:"BugCard",inheritAttrs:!1,components:{BugFixTitle:tt,BugActions:H},props:{theme:String,bugCase:String}},it=et,nt=i("12b2"),st=Object(p["a"])(it,L,V,!1,null,"82a30bc0",null),at=st.exports;b()(st,{VCard:h["a"],VCardText:J["b"],VCardTitle:nt["a"]});var rt=i("2f62"),lt=i("2c57"),ct={name:"BugTracking",mixins:[lt["a"]],data:function(){return{query:void 0,resetId:+new Date,infiniteId:+new Date}},metaInfo:{title:w["o"].BUG_TRACKING},components:{SideList:I,BugCard:at,SideBar:A,List:r["a"]},computed:Object(a["a"])({},Object(rt["c"])(["getUserId"])),methods:{pullToRefresh:function(t){t("done"),this.resetList()},resetList:function(){++this.resetId},applyAllFilter:function(){this.query=void 0,this.resetList()},applyNotAssignedFilter:function(){this.query="fixer_id==null",this.resetList()},applyAssignedMeFilter:function(){this.query="status=="+w["d"].PENDING+";fixer_id=="+this.getUserId,this.resetList()},applyClosedFilter:function(){this.query="status=="+w["d"].CLOSED+";fixer_id=="+this.getUserId,this.resetList()},applyIgnoredFilter:function(){this.query="status=="+w["d"].IGNORED+";fixer_id=="+this.getUserId,this.resetList()},infiniteLoad:function(t,e){return j["a"].getBugsTracking(t,e,this.query)}}},ot=ct,ut=Object(p["a"])(ot,n,s,!1,null,"50f213df",null);e["default"]=ut.exports;b()(ut,{VCard:h["a"],VCardText:J["b"]})},"79a3":function(t,e,i){"use strict";var n=i("d91a"),s=i("bc3a");function a(t,e,i){return s.get(Object(n["b"])("bugs")+"?limit="+t+"&offset="+e+(i?"&query="+i:""))}function r(t,e,i){return s.get(Object(n["b"])("bugs/tracking")+"?limit="+t+"&offset="+e+(i?"&query="+i:""))}function l(t,e){return s.patch(Object(n["b"])("bugs/"+t+"/assign-me"),e)}function c(t,e){return s.patch(Object(n["b"])("bugs/"+t+"/complete"),e)}function o(t){return s.post(Object(n["b"])("bugs"),t)}e["a"]={getBugs:a,getBugsTracking:r,create:o,assignMe:l,complete:c}},"88e9":function(t,e,i){"use strict";var n=i("f8af"),s=i.n(n);s.a},f8af:function(t,e,i){}}]);
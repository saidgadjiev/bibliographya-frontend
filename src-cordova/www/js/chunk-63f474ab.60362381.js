(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-63f474ab"],{"21b6":function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-layout",{attrs:{"justify-center":"",row:""}},[i("v-flex",{attrs:{xs12:"",md8:""}},[i("alert-message"),e.loadingCategory?i("v-layout",{staticClass:"ma-0 pa-0",attrs:{"justify-center":"",row:""}},[i("progress-circular")],1):i("v-card",[i("v-img",{attrs:{src:e._imageSrc,height:"200"}},[i("v-layout",{attrs:{slot:"placeholder","fill-height":"","align-center":"","justify-center":"","ma-0":""},slot:"placeholder"},[i("progress-circular")],1)],1),i("v-card-text",{staticStyle:{"justify-content":"center"}},[i("v-form",[i("v-text-field",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{"error-messages":e.errors.collect("name"),label:"Название категории",type:"text",name:"name"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}}),i("input",{directives:[{name:"validate",rawName:"v-validate",value:"size:5000",expression:"'size:5000'"}],ref:"file",staticStyle:{display:"none"},attrs:{type:"file",id:"file",accept:"image/*",name:"file"},on:{change:function(t){return e.handleFileUpload()}}}),i("v-btn",{staticClass:"primary",attrs:{block:""},on:{click:e.selectFile}},[e._v("Загрузить картинку")]),e.file?i("v-btn",{staticClass:"white--text",attrs:{block:"",color:"red darken-3"},on:{click:e.resetFile}},[e._v("Сбросить")]):e._e(),e._isEdit||e.file?e._e():i("div",{staticClass:"error--text word-break-word"},[e._v("\n            Выберите картинку\n          ")])],1)],1),i("v-card-actions",{staticStyle:{"justify-content":"center"}},[i("v-btn",{staticClass:"white--text",attrs:{color:"blue darken-3",loading:e.saving,disabled:e.saving},on:{click:function(t){return e.save()}}},[e._v("\n          Сохранить\n        ")])],1)],1)],1),e.$vuetify.breakpoint.mdAndUp?i("v-flex",{attrs:{md4:""}}):e._e()],1)},r=[],n=(i("06db"),i("f499")),s=i.n(n),o=(i("c5f6"),i("22b8")),c=i("1b98"),l=i("dcdb"),u=i("c7da"),d=i("cc57"),f=i("29c5"),m=i("d91a"),h={name:"CategoryCard",mixins:[d["a"]],components:{ProgressCircular:f["a"],AlertMessage:l["a"]},data:function(){return{saving:!1,loadingCategory:!1,loadingImage:!0,file:void 0,previewImagePath:void 0,currentImagePath:"",form:{id:"",name:"",imagePath:""}}},props:{categoryId:{type:Number}},created:function(){this.$validator.localize("ru",{custom:{name:{required:function(){return"Введите название категории"}},file:{size:function(){return"Максимальный размер файла 5Мб"}}}}),this._isEdit&&this.loadCategory()},computed:{_isEdit:function(){return!!this.categoryId},_imageSrc:function(){return this.previewImagePath?this.previewImagePath:this._isEdit?o["a"].getCategoryResourceUrl(this.form.imagePath):o["a"].getCategoryResourceUrl(m["a"])}},methods:{resetForm:function(){this.resetFile(),this.form.id="",this.form.name="",this.form.imagePath="",this.$validator.reset()},save:function(){var e=this;this.$validator.validateAll().then(function(t){if(t)if(e.saving=!0,e._isEdit){e.saving=!0;var i=new FormData;i.set("data",s()({name:e.form.name})),e.file&&i.set("file",e.file),c["a"].edit(e.categoryId,i).then(function(t){e.currentImagePath=t.data.imagePath,e.form.imagePath=t.data.imagePath,e.setAlertSuccess(u["c"]),e.resetFile()}).finally(function(){e.saving=!1})}else{var a=new FormData;a.set("data",s()({name:e.form.name})),e.file&&a.set("file",e.file),c["a"].create(a).then(function(){e.resetForm(),e.setAlertSuccess(u["d"]),e.saving=!1}).finally(function(){e.saving=!1})}})},selectFile:function(){this.$refs.file.click()},resetFile:function(){this.previewImagePath=void 0,this.file=void 0,this.form.imagePath=this.currentImagePath,this.$refs.file.value=null},loadCategory:function(){var e=this;e.loadingCategory=!0,c["a"].getCategory(this.categoryId).then(function(t){e.currentImagePath=t.data.imagePath,e.form.id=t.data.id,e.form.name=t.data.name,e.form.imagePath=t.data.imagePath},function(e){}).finally(function(){e.loadingCategory=!1})},handleFileUpload:function(){this.file=this.$refs.file.files[0];var e=new FileReader;e.addEventListener("load",function(){this.previewImagePath=e.result}.bind(this),!1),this.file&&/\.(jpe?g|png|gif)$/i.test(this.file.name)&&e.readAsDataURL(this.file)}}},v=h,g=(i("3c05"),i("2877")),p=i("6544"),y=i.n(p),b=i("8336"),_=i("b0af"),w=i("99d9"),C=i("0e8f"),x=i("4bd4"),$=i("adda"),I=i("a722"),k=i("2677"),P=Object(g["a"])(v,a,r,!1,null,"4735a9af",null);t["default"]=P.exports;y()(P,{VBtn:b["a"],VCard:_["a"],VCardActions:w["a"],VCardText:w["b"],VFlex:C["a"],VForm:x["a"],VImg:$["a"],VLayout:I["a"],VTextField:k["a"]})},"3c05":function(e,t,i){"use strict";var a=i("f8dc"),r=i.n(a);r.a},a57f:function(e,t,i){},dcdb:function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"alert"}},[i("v-alert",{attrs:{dismissible:"",type:e._alertType},model:{value:e._alert,callback:function(t){e._alert=t},expression:"_alert"}},[e._v("\n    "+e._s(e.alertMessage)+"\n  ")])],1)},r=[],n=i("3284"),s=i("db49"),o=i("cc57"),c={name:"AlertMessage",mixins:[o["a"]],data:function(){return{options:{duration:300,offset:10,easing:"easeInOutCubic"}}},computed:{_alert:{get:function(){return-1!==this.types.indexOf(this.alertType)},set:function(e){this.clearAlert()}},_alertType:function(){return"alert-success"===this.alertType?"success":"error"}},props:{types:{type:Array,default:function(){return["alert-success","alert-danger"]}}},created:function(){n["b"].$on(s["k"].ALERT,this.alert)},beforeDestroy:function(){n["b"].$off(s["k"].ALERT)},methods:{alert:function(){var e=this;-1!==e.types.indexOf(e.alertType)&&e.$nextTick(function(){e.$vuetify.goTo("#alert",e.options)})}}},l=c,u=i("2877"),d=i("6544"),f=i.n(d),m=(i("a57f"),i("9d26")),h=i("b64a"),v=i("98a1"),g=i("00ab"),p=i("58df"),y=Object(p["a"])(h["a"],v["a"],g["a"]).extend({name:"v-alert",props:{dismissible:Boolean,icon:String,outline:Boolean,type:{type:String,validator:function(e){return["info","error","success","warning"].includes(e)}}},computed:{computedColor:function(){return this.type&&!this.color?this.type:this.color||"error"},computedIcon:function(){if(this.icon||!this.type)return this.icon;switch(this.type){case"info":return"$vuetify.icons.info";case"error":return"$vuetify.icons.error";case"success":return"$vuetify.icons.success";case"warning":return"$vuetify.icons.warning"}}},methods:{genIcon:function(){return this.computedIcon?this.$createElement(m["a"],{class:"v-alert__icon"},this.computedIcon):null},genDismissible:function(){var e=this;return this.dismissible?this.$createElement("a",{class:"v-alert__dismissible",on:{click:function(){e.isActive=!1}}},[this.$createElement(m["a"],{props:{right:!0}},"$vuetify.icons.cancel")]):null}},render:function(e){var t=[this.genIcon(),e("div",this.$slots.default),this.genDismissible()],i=this.outline?this.setTextColor:this.setBackgroundColor,a=e("div",i(this.computedColor,{staticClass:"v-alert",class:{"v-alert--outline":this.outline},directives:[{name:"show",value:this.isActive}],on:this.$listeners}),t);return this.transition?e("transition",{props:{name:this.transition,origin:this.origin,mode:this.mode}},[a]):a}}),b=Object(u["a"])(l,a,r,!1,null,"1e43e7c6",null);t["a"]=b.exports;f()(b,{VAlert:y})},f8dc:function(e,t,i){}}]);